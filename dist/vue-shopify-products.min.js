/*!
 * Vue Shopify Products
 * ====================
 *
 * Format shopify CSV files into a usable object.
 * https://github.com/mikestreety/vue-shopify-products
 *
 * Copyright 2017 Mike Street
 */
const ShopifyProducts={install(e){let a=function(e){return e.trim().toLowerCase().replace(/^\/|\/$/g,"").replace(/ /g,"-").replace(/\//g,"-").replace(/[-]+/g,"-").replace(/[^\w-]+/g,"")};e.prototype.$formatProducts=function(e){let t=[];if(e.fields){let r=e.fields;for(let i of e.records){let e={};r.forEach((t,r)=>{e[a(t)]=i[r]}),t.push(e)}}else for(let r of e){let e={};Object.keys(r).forEach(t=>{e[a(t)]=r[t]}),t.push(e)}let r={};for(let e of t){let t=e.handle,i=r[t];i||(i={title:e.title,body:e["body-html"],handle:t,vendor:{title:e.vendor,handle:a(e.vendor)},type:{title:e.type,handle:a(e.type)},tags:e.tags.split(",").map(e=>({title:e.trim(),handle:a(e)})),images:[],variationTypes:{},variationProducts:[]}),e["image-src"]&&i.images.push({source:e["image-src"],alt:e["image-alt-text"]});for(let t=1;t<4;t++)e.hasOwnProperty("option"+t+"-name")&&null!==e["option"+t+"-name"]&&(i.variationTypes[t]={id:t,value:e["option"+t+"-name"],slug:a(e["option"+t+"-name"])});let o={barcode:e["variant-barcode"],comaprePrice:e["variant-compare-at-price"],grams:e["variant-grams"],quantity:e["variant-inventory-qty"],price:e["variant-price"],shipping:e["variant-requires-shipping"],sku:e["variant-sku"],taxable:e["variant-taxable"],variant:{}};e["variant-image"]&&(o.image={source:e["variant-image"],alt:e.title});for(let t in i.variationTypes)t=i.variationTypes[t],o.variant[a(t.value)]={name:t.value,value:e["option"+t.id+"-value"]};Object.keys(o).forEach(e=>null==o[e]&&delete o[e]),i.variationProducts.push(o),r[t]=i}return r}}};